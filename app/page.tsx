'use client';

import { useState, useRef, useEffect } from 'react';
import { Send, Image as ImageIcon } from 'lucide-react';

export default function Home() {
  const [messages, setMessages] = useState([
    {
      role: 'assistant',
      content: 'Welcome! I\'m here to help review creative materials and provide feedback on videos, designs, copy, and media strategy based on Tennis Channel brand standards. What would you like me to look at today?'
    }
  ]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [uploadedImages, setUploadedImages] = useState<string[]>([]);
  const messagesEndRef = useRef<HTMLDivElement>(null);
  const fileInputRef = useRef<HTMLInputElement>(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const handleSubmit = async () => {
    if ((!input.trim() && uploadedImages.length === 0) || isLoading) return;

    const userMessage: any = { 
      role: 'user', 
      content: uploadedImages.length > 0 ? [
        ...(input.trim() ? [{ type: 'text', text: input }] : []),
        ...uploadedImages.map(img => ({ type: 'image_url', image_url: { url: img } }))
      ] : input
    };
    
    const updatedMessages = [...messages, userMessage];
    setMessages(updatedMessages);
    setInput('');
    setUploadedImages([]);
    setIsLoading(true);

    try {
      const response = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          messages: updatedMessages
        })
      });

      const data = await response.json();
      
      if (data.error) {
        throw new Error(data.error);
      }

      setMessages(prev => [...prev, {
        role: 'assistant',
        content: data.response
      }]);
    } catch (error) {
      console.error('Error:', error);
      setMessages(prev => [...prev, {
        role: 'assistant',
        content: 'Sorry, I encountered an error. Please try again.'
      }]);
    } finally {
      setIsLoading(false);
    }
  };

  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = e.target.files;
    if (!files) return;

    Array.from(files).forEach(file => {
      const reader = new FileReader();
      reader.onloadend = () => {
        setUploadedImages(prev => [...prev, reader.result as string]);
      };
      reader.readAsDataURL(file);
    });
  };

  const removeImage = (index: number) => {
    setUploadedImages(prev => prev.filter((_, i) => i !== index));
  };

  const formatText = (text: string) => {
    // Convert **bold** to actual bold
    let formatted = text.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
    // Convert numbered lists to proper formatting
    formatted = formatted.replace(/^(\d+)\.\s/gm, '<br/><strong>$1.</strong> ');
    // Convert line breaks
    formatted = formatted.replace(/\n/g, '<br/>');
    return formatted;
  };

  const handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSubmit();
    }
  };

  return (
    <div className="flex flex-col h-screen bg-gradient-to-t from-[#00225D] to-[#4472C4]">
      <style jsx global>{`
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Roboto:wght@400&display=swap');
      `}</style>
      
      {/* Header with dual branding */}
      <header className="bg-white/95 backdrop-blur-sm border-b border-gray-200 py-6 shadow-lg">
        <div className="max-w-5xl mx-auto px-6">
          <div className="flex items-center justify-center gap-8 mb-4">
            {/* Direct Agents Logo */}
            <div className="h-16 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0.00 0.00 1200.00 457.00" className="h-12 w-auto">
                <path fill="#1a9ed9" d="M 236.13 0.00 Q 319.98 3.63 381.62 58.13 Q 415.03 87.66 435.25 129.25 C 475.52 212.09 461.38 311.48 400.09 380.10 A 0.28 0.28 0.0 0 1 399.68 380.11 L 389.94 370.38 A 0.75 0.74 -46.8 0 1 389.91 369.37 Q 408.53 347.89 422.30 319.79 Q 442.22 279.11 442.65 232.99 C 443.18 175.81 423.51 120.82 383.22 80.29 C 326.36 23.09 244.17 0.81 166.73 24.25 Q 123.22 37.41 87.09 67.93 A 0.56 0.55 -42.3 0 1 86.33 67.90 L 76.54 58.11 A 0.30 0.30 0.0 0 1 76.55 57.67 Q 139.61 2.79 223.71 0.00 L 236.13 0.00 Z"/>
                <path fill="#656668" d="M 236.26 457.00 L 221.02 457.00 Q 151.33 453.44 98.12 416.02 Q 53.61 384.72 27.75 337.56 Q 2.50 291.51 0.00 235.92 L 0.00 221.35 Q 3.55 138.69 57.81 76.68 A 0.26 0.26 0.0 0 1 58.19 76.67 L 68.04 86.51 A 0.64 0.63 43.3 0 1 68.07 87.37 C 40.33 119.95 20.75 160.68 16.55 203.50 Q 10.26 267.63 37.18 323.83 C 52.50 355.82 76.48 382.09 105.61 402.67 C 157.86 439.58 223.72 451.20 285.66 434.29 Q 332.29 421.56 370.63 389.03 A 0.56 0.55 46.9 0 1 371.39 389.06 L 380.98 398.65 A 0.52 0.51 44.6 0 1 380.99 399.37 Q 380.04 400.35 375.96 403.71 Q 315.34 453.65 236.26 457.00 Z"/>
                <path fill="#1a9ed9" d="M 1148.87 92.08 A 0.23 0.23 0.0 0 1 1149.03 92.47 L 1136.34 104.57 A 1.45 1.44 -67.5 0 1 1135.36 104.98 Q 1126.36 105.18 1116.53 105.40 C 1113.81 105.46 1113.24 103.97 1113.25 101.51 Q 1113.25 99.15 1113.26 95.26 C 1113.27 92.75 1114.87 92.12 1117.21 92.13 Q 1125.75 92.13 1148.87 92.08 Z"/>
                <path fill="#1a9ed9" d="M 1150.32 92.17 Q 1190.64 92.02 1197.51 92.28 Q 1199.37 92.35 1199.59 94.99 Q 1199.93 99.25 1199.57 102.90 Q 1199.33 105.37 1196.67 105.37 Q 1181.71 105.40 1163.60 105.38 A 0.38 0.38 0.0 0 0 1163.22 105.76 Q 1163.22 166.46 1163.22 202.29 C 1163.22 204.94 1162.57 205.82 1160.02 205.91 Q 1156.42 206.04 1152.01 205.80 Q 1149.68 205.67 1149.68 203.00 Q 1149.72 143.79 1149.68 92.81 A 0.65 0.64 -0.5 0 1 1150.32 92.17 Z"/>
                <path fill="#1a9ed9" d="M 999.54 150.22 C 999.60 184.24 1035.06 207.51 1065.74 190.95 Q 1070.86 188.18 1076.48 183.65 A 2.32 2.32 0.0 0 1 1079.45 183.71 Q 1081.61 185.60 1084.36 188.34 Q 1085.88 189.85 1084.77 191.96 A 2.13 2.07 82.9 0 1 1084.33 192.54 Q 1068.52 207.36 1046.52 207.99 C 1013.74 208.93 986.46 183.16 986.41 150.24 C 986.35 117.32 1013.53 91.45 1046.32 92.28 Q 1068.32 92.83 1084.18 107.60 A 2.13 2.07 -83.1 0 1 1084.63 108.18 Q 1085.74 110.29 1084.23 111.80 Q 1081.49 114.55 1079.34 116.45 A 2.32 2.32 0.0 0 1 1076.37 116.52 Q 1070.73 112.01 1065.60 109.26 C 1034.86 92.80 999.48 116.19 999.54 150.22 Z"/>
                <path fill="#656668" d="M 348.93 343.61 L 348.93 242.00 A 0.61 0.60 90.0 0 0 348.33 241.39 L 158.26 241.39 A 0.43 0.43 0.0 0 0 157.83 241.82 L 157.83 343.69 A 0.59 0.59 0.0 0 1 157.24 344.28 L 135.25 344.28 A 0.60 0.60 0.0 0 1 134.65 343.68 L 134.65 185.61 A 0.27 0.27 0.0 0 1 134.92 185.34 L 157.22 185.34 A 0.61 0.60 0.0 0 1 157.83 185.94 L 157.83 217.64 A 0.64 0.64 0.0 0 0 158.47 218.28 L 347.48 218.28 A 0.47 0.47 0.0 0 0 347.95 217.78 C 346.09 192.70 336.43 167.42 318.69 149.29 C 294.30 124.37 261.71 116.00 227.49 116.01 Q 145.29 116.01 135.80 115.98 A 0.53 0.53 0.0 0 1 135.27 115.43 C 135.66 105.09 142.23 96.44 152.22 93.71 Q 155.17 92.91 161.85 92.91 C 190.66 92.93 213.21 93.26 234.32 92.79 Q 264.33 92.12 291.67 103.53 C 306.25 109.62 318.77 116.69 330.16 127.32 C 351.46 147.21 365.98 172.01 370.67 200.77 Q 372.41 211.41 372.23 234.31 Q 372.08 252.73 372.20 343.61 A 0.67 0.67 0.0 0 1 371.53 344.28 L 349.60 344.28 A 0.67 0.67 0.0 0 1 348.93 343.61 Z"/>
                <path fill="#1a9ed9" d="M 543.02 94.71 A 2.08 2.08 0.0 0 1 545.10 92.63 L 582.53 92.57 A 57.47 56.35 -0.1 0 1 640.10 148.82 L 640.10 149.96 A 57.47 56.35 -0.1 0 1 582.73 206.41 L 545.30 206.47 A 2.08 2.08 0.0 0 1 543.22 204.39 L 543.02 94.71 Z M 556.09 105.86 L 556.25 193.10 A 0.27 0.27 0.0 0 0 556.52 193.37 L 583.04 193.32 A 43.89 43.00 -0.1 0 0 626.85 150.25 L 626.85 148.47 A 43.89 43.00 -0.1 0 0 582.88 105.54 L 556.36 105.59 A 0.27 0.27 0.0 0 0 556.09 105.86 Z"/>
                <rect fill="#1a9ed9" x="688.17" y="92.71" width="13.48" height="113.78" rx="2.41"/>
                <path fill="#1a9ed9" d="M 836.15 205.80 A 0.40 0.39 74.1 0 1 835.82 206.40 Q 830.73 206.49 823.01 206.45 Q 820.55 206.44 819.15 204.12 Q 806.72 183.52 795.26 164.61 A 0.69 0.67 74.1 0 0 794.68 164.28 L 768.26 164.28 A 0.61 0.61 0.0 0 0 767.65 164.89 Q 767.63 195.66 767.66 203.73 Q 767.67 206.45 765.50 206.41 Q 765.08 206.40 757.01 206.47 C 754.64 206.49 754.41 205.04 754.41 202.96 Q 754.41 172.13 754.40 154.24 C 754.40 150.89 756.95 151.18 759.82 151.18 Q 802.07 151.19 803.79 151.18 A 8.61 7.98 36.5 0 0 805.42 151.00 Q 816.61 148.51 821.98 138.25 C 828.50 125.78 821.04 110.25 807.73 106.38 Q 804.92 105.57 798.23 105.64 Q 793.07 105.69 764.01 105.66 Q 761.54 105.66 761.45 103.53 Q 761.26 99.43 761.38 95.33 C 761.46 92.95 762.36 92.66 764.75 92.66 Q 799.84 92.66 803.00 92.67 C 822.04 92.71 837.12 109.14 837.70 127.51 C 838.22 143.84 826.88 158.66 811.23 163.13 A 0.44 0.43 66.8 0 0 810.98 163.77 L 836.15 205.80 Z"/>
                <path fill="#1a9ed9" d="M 896.48 154.67 A 0.71 0.71 0.0 0 0 895.77 155.38 L 895.77 195.05 A 0.61 0.60 -90.0 0 0 896.37 195.66 Q 924.44 195.67 949.81 195.65 C 952.38 195.65 953.23 197.32 953.25 199.75 C 953.26 201.95 953.84 205.31 951.06 206.35 A 1.44 1.34 -53.4 0 1 950.57 206.44 Q 926.78 206.47 886.37 206.43 C 883.92 206.43 883.31 204.48 883.30 202.25 Q 883.25 107.56 883.37 96.60 Q 883.40 94.02 886.42 93.97 Q 895.75 93.82 950.59 93.92 C 953.60 93.92 953.28 98.07 953.23 100.81 C 953.19 103.41 952.23 104.67 949.58 104.67 Q 936.03 104.63 896.39 104.65 A 0.63 0.62 -0.5 0 0 895.77 105.26 L 895.77 143.49 A 0.40 0.39 0.0 0 0 896.16 143.88 Q 940.06 143.86 942.04 143.89 C 945.87 143.96 945.33 147.75 945.28 151.27 C 945.24 154.01 943.65 154.69 941.08 154.68 Q 930.13 154.66 896.48 154.67 Z"/>
                <path fill="#1a9ed9" d="M 319.70 195.19 L 293.15 195.19 A 0.83 0.83 0.0 0 1 292.36 194.62 C 288.59 183.29 279.99 172.90 269.06 167.71 Q 264.40 165.49 256.59 164.27 Q 244.25 162.33 234.01 162.28 Q 198.83 162.11 111.95 162.21 A 0.55 0.54 90.0 0 0 111.41 162.76 L 111.41 320.58 A 0.53 0.53 0.0 0 1 110.88 321.11 C 101.13 321.21 92.93 314.98 89.54 306.29 Q 88.03 302.43 88.12 293.02 Q 88.21 283.66 88.16 161.75 C 88.16 152.15 94.52 143.73 103.19 140.47 Q 106.79 139.11 115.98 139.12 C 185.01 139.13 221.23 138.69 246.74 139.67 C 266.86 140.44 286.46 147.01 300.66 161.51 Q 314.32 175.45 320.23 194.47 A 0.56 0.56 0.0 0 1 319.70 195.19 Z"/>
                <path fill="#656668" d="M 612.28 301.28 L 555.40 301.28 A 0.40 0.40 0.0 0 0 555.00 301.68 L 555.00 341.35 A 2.53 2.53 0.0 0 1 552.60 343.88 Q 550.64 343.98 545.26 343.92 C 542.95 343.89 542.35 342.58 542.35 340.42 Q 542.36 256.77 542.35 236.76 C 542.34 233.55 540.83 229.77 545.86 229.81 Q 557.20 229.90 581.68 229.87 Q 586.51 229.87 591.99 231.20 C 609.57 235.48 621.18 247.89 624.80 265.45 Q 625.66 269.64 625.66 278.61 Q 625.63 339.58 625.65 340.98 C 625.68 343.35 624.20 343.95 622.02 343.94 Q 616.60 343.94 615.48 343.89 A 3.33 3.17 -33.9 0 1 614.72 343.76 Q 612.95 343.24 612.97 340.25 Q 613.03 331.30 613.00 301.99 A 0.72 0.71 0.0 0 0 612.28 301.28 Z M 555.00 243.13 L 555.00 288.36 A 0.37 0.36 0.0 0 0 555.37 288.72 L 612.67 288.72 A 0.30 0.30 0.0 0 0 612.97 288.43 Q 613.09 281.07 612.94 274.00 C 612.51 254.48 599.35 242.55 580.02 242.42 Q 561.66 242.29 555.63 242.48 A 0.65 0.65 0.0 0 0 555.00 243.13 Z"/>
                <path fill="#656668" d="M 744.27 326.64 Q 744.56 321.44 744.16 295.80 Q 744.11 292.97 747.03 292.80 Q 751.23 292.56 754.22 292.81 Q 755.88 292.95 756.61 295.20 A 0.76 0.54 -61.6 0 1 756.63 295.37 Q 756.64 298.74 756.66 331.76 Q 756.66 334.51 754.63 335.62 C 732.31 347.89 703.83 350.29 682.31 335.76 C 653.96 316.61 648.59 277.81 670.08 251.33 C 683.54 234.74 705.14 227.18 726.10 230.91 Q 742.08 233.75 754.73 245.27 Q 756.23 246.63 755.24 248.74 A 1.07 1.06 -10.9 0 1 755.02 249.06 L 749.60 254.48 A 2.00 1.99 -46.6 0 1 746.87 254.56 C 733.76 242.92 715.08 236.90 697.80 244.76 C 668.85 257.94 661.01 294.87 682.13 318.82 C 697.78 336.57 722.62 337.58 743.72 327.48 A 1.00 1.00 0.0 0 0 744.27 326.64 Z"/>
                <path fill="#656668" d="M 910.48 253.93 Q 910.42 296.44 910.46 340.27 Q 910.46 344.11 907.27 344.16 C 904.17 344.21 898.65 345.28 898.65 340.75 Q 898.64 324.99 898.65 232.52 C 898.65 229.70 903.06 229.84 905.48 230.07 A 1.17 1.15 -16.2 0 1 906.26 230.49 L 978.69 320.32 A 0.25 0.25 0.0 0 0 979.13 320.16 Q 979.09 253.18 979.16 234.28 Q 979.17 231.91 982.13 231.70 C 985.02 231.50 989.43 230.92 990.55 233.23 Q 990.93 234.01 990.93 235.89 Q 990.93 303.69 990.93 342.95 A 2.67 2.67 0.0 0 1 989.20 345.45 Q 987.75 345.99 985.46 345.79 A 1.29 1.27 -16.4 0 1 984.57 345.31 L 910.80 253.82 A 0.18 0.18 0.0 0 0 910.48 253.93 Z"/>
                <path fill="#656668" d="M 1200.00 314.22 L 1200.00 319.23 Q 1198.01 332.56 1186.48 339.73 C 1168.74 350.75 1146.21 345.76 1130.89 332.81 C 1128.89 331.12 1128.37 329.50 1129.89 327.36 C 1132.16 324.18 1134.62 319.61 1138.95 323.56 C 1147.79 331.61 1160.34 337.14 1172.50 334.07 C 1182.10 331.65 1189.19 323.11 1186.44 313.02 C 1184.04 304.20 1174.13 298.78 1166.25 295.25 C 1150.32 288.12 1134.26 282.69 1130.88 265.89 Q 1128.76 255.36 1133.35 246.58 C 1143.92 226.38 1171.26 226.97 1188.70 236.05 C 1192.02 237.78 1195.59 239.13 1193.50 243.37 Q 1192.62 245.17 1190.27 248.08 A 1.83 1.80 -78.6 0 1 1189.46 248.63 Q 1187.53 249.24 1186.29 248.45 C 1177.10 242.61 1166.90 238.87 1155.98 241.88 C 1141.07 245.99 1137.31 263.31 1149.52 273.05 Q 1154.48 277.00 1160.03 279.33 Q 1170.27 283.62 1177.94 287.35 C 1189.50 292.97 1198.52 300.70 1200.00 314.22 Z"/>
                <path fill="#656668" d="M 1057.98 230.45 A 0.22 0.22 0.0 0 1 1058.14 230.84 L 1045.48 242.82 A 1.44 1.43 -67.3 0 1 1044.51 243.23 Q 1035.56 243.39 1025.79 243.58 C 1023.08 243.63 1022.52 242.15 1022.54 239.70 Q 1022.55 237.36 1022.57 233.49 C 1022.59 230.99 1024.18 230.37 1026.51 230.39 Q 1035.00 230.42 1057.98 230.45 Z"/>
                <path fill="#656668" d="M 1059.04 231.04 A 0.65 0.64 -0.5 0 1 1059.68 230.40 Q 1100.02 230.25 1106.89 230.51 Q 1108.75 230.58 1108.97 233.22 Q 1109.31 237.48 1108.95 241.13 Q 1108.71 243.60 1106.05 243.60 Q 1091.09 243.63 1072.97 243.61 A 0.38 0.38 0.0 0 0 1072.59 243.99 Q 1072.60 304.71 1072.60 340.55 C 1072.60 343.20 1071.95 344.08 1069.40 344.17 Q 1065.80 344.30 1061.39 344.07 Q 1059.06 343.94 1059.06 341.26 Q 1059.09 282.04 1059.04 231.04 Z"/>
                <path fill="#656668" d="M 803.18 293.11 L 803.18 332.79 A 0.61 0.60 -90.0 0 0 803.78 333.40 Q 831.86 333.41 857.24 333.39 C 859.81 333.39 860.67 335.06 860.69 337.49 C 860.70 339.69 861.28 343.05 858.50 344.09 A 1.44 1.34 -53.4 0 1 858.01 344.18 Q 834.20 344.21 793.78 344.18 C 791.33 344.18 790.72 342.23 790.71 340.00 Q 790.65 245.27 790.76 234.30 Q 790.79 231.72 793.82 231.67 Q 803.15 231.52 858.01 231.61 C 861.02 231.61 860.70 235.77 860.65 238.51 C 860.61 241.11 859.65 242.37 857.00 242.37 Q 843.45 242.33 803.79 242.35 A 0.63 0.62 -0.5 0 0 803.17 242.97 L 803.17 281.21 A 0.40 0.39 -0.0 0 0 803.57 281.60 Q 847.48 281.58 849.46 281.61 C 853.30 281.68 852.76 285.47 852.71 288.99 C 852.67 291.73 851.08 292.41 848.51 292.40 Q 837.55 292.38 803.89 292.40 A 0.71 0.71 0.0 0 0 803.18 293.11 Z"/>
                <path fill="#1a9ed9" d="M 181.06 320.56 L 181.06 298.66 A 0.59 0.58 0.0 0 1 181.65 298.08 Q 206.51 298.23 230.99 298.03 Q 243.82 297.92 258.14 295.41 Q 268.74 293.55 275.93 288.26 Q 287.88 279.47 292.45 265.00 A 0.78 0.77 -81.3 0 1 293.19 264.45 L 319.76 264.45 A 0.55 0.55 0.0 0 1 320.29 265.13 C 314.52 287.65 300.33 305.94 278.85 314.49 Q 272.54 317.00 262.22 318.40 C 235.34 322.07 216.41 321.30 181.65 321.15 A 0.59 0.59 0.0 0 1 181.06 320.56 Z"/>
              </svg>
            </div>
            
            {/* Tennis Channel Logo */}
            <div className="h-16 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0.00 0.00 1036.00 300.00" className="h-12 w-auto">
                <path fill="#00225D" d="M 954.88 0.00 C 975.94 1.28 994.34 8.35 1001.76 29.71 Q 1004.57 37.79 1004.23 51.30 A 0.60 0.60 0.0 0 1 1003.63 51.88 L 971.07 51.88 A 0.66 0.66 0.0 0 1 970.41 51.21 Q 970.47 41.86 967.37 34.97 C 963.39 26.12 953.20 24.50 944.51 26.73 Q 932.50 29.81 931.44 42.52 C 930.33 55.67 934.60 63.55 946.63 68.70 Q 972.85 79.92 982.02 84.24 C 995.16 90.43 1006.39 100.28 1008.90 115.05 Q 1011.16 128.41 1008.79 141.76 Q 1004.96 163.36 986.66 172.90 C 970.11 181.53 948.26 182.32 930.04 179.02 C 919.65 177.14 909.64 172.52 903.22 164.04 C 894.66 152.73 892.86 137.96 893.73 123.90 A 0.56 0.55 1.6 0 1 894.29 123.38 L 928.28 123.38 A 0.60 0.59 0.0 0 1 928.88 123.97 C 928.90 130.78 928.95 135.60 930.20 141.05 C 932.74 152.18 943.22 156.21 953.56 155.57 C 963.72 154.94 972.32 148.11 973.01 137.50 C 973.57 128.88 972.40 121.26 965.48 115.52 Q 960.86 111.69 955.53 109.46 C 944.22 104.72 929.69 100.87 917.58 93.45 Q 901.83 83.80 897.59 66.84 C 894.62 54.96 895.28 39.60 899.92 27.69 C 905.91 12.31 920.62 3.30 936.76 1.02 Q 940.73 0.46 944.74 0.00 L 954.88 0.00 Z"/>
                <path fill="#00225D" d="M 0.25 24.37 L 0.25 3.36 A 0.36 0.36 0.0 0 1 0.61 3.00 L 296.01 3.00 A 0.36 0.36 0.0 0 1 296.37 3.36 L 296.37 63.50 A 0.36 0.36 0.0 0 1 295.96 63.86 L 0.56 24.73 A 0.36 0.36 0.0 0 1 0.25 24.37 Z"/>
                <path fill="#00225D" d="M 367.72 3.12 Q 419.83 3.14 423.27 3.13 A 0.33 0.33 0.0 0 1 423.60 3.46 L 423.60 31.40 A 0.36 0.36 0.0 0 1 423.24 31.76 L 385.83 31.76 A 0.43 0.43 0.0 0 0 385.40 32.19 L 385.36 177.41 A 0.72 0.71 85.0 0 1 384.77 178.11 Q 384.68 178.13 367.67 178.13 Q 350.66 178.12 350.57 178.11 A 0.72 0.71 -84.9 0 1 349.98 177.40 L 350.03 32.18 A 0.43 0.43 0.0 0 0 349.60 31.75 L 312.19 31.73 A 0.36 0.36 0.0 0 1 311.83 31.37 L 311.84 3.43 A 0.33 0.33 0.0 0 1 312.17 3.10 Q 315.61 3.11 367.72 3.12 Z"/>
                <path fill="#00225D" d="M 473.74 102.41 L 473.74 148.96 A 0.41 0.41 0.0 0 0 474.15 149.37 L 538.22 149.37 A 0.41 0.41 0.0 0 1 538.63 149.78 L 538.63 177.72 A 0.41 0.41 0.0 0 1 538.22 178.13 L 438.75 178.13 A 0.41 0.41 0.0 0 1 438.34 177.72 L 438.34 3.53 A 0.41 0.41 0.0 0 1 438.75 3.12 L 535.72 3.12 A 0.41 0.41 0.0 0 1 536.13 3.53 L 536.13 31.34 A 0.41 0.41 0.0 0 1 535.72 31.75 L 474.15 31.75 A 0.41 0.41 0.0 0 0 473.74 32.16 L 473.74 72.85 A 0.41 0.41 0.0 0 0 474.15 73.26 L 532.21 73.26 A 0.41 0.41 0.0 0 1 532.62 73.67 L 532.62 101.59 A 0.41 0.41 0.0 0 1 532.21 102.00 L 474.15 102.00 A 0.41 0.41 0.0 0 0 473.74 102.41 Z"/>
                <path fill="#00225D" d="M 640.25 3.16 L 671.84 3.16 A 0.31 0.31 0.0 0 1 672.15 3.47 L 672.15 177.80 A 0.31 0.31 0.0 0 1 671.84 178.11 L 632.43 178.11 A 0.31 0.31 0.0 0 1 632.14 177.90 L 589.37 55.81 A 0.31 0.31 0.0 0 0 588.77 55.91 L 588.77 177.80 A 0.31 0.31 0.0 0 1 588.46 178.11 L 556.91 178.11 A 0.31 0.31 0.0 0 1 556.60 177.80 L 556.60 3.46 A 0.31 0.31 0.0 0 1 556.91 3.15 L 597.14 3.15 A 0.31 0.31 0.0 0 1 597.43 3.36 L 639.34 123.02 A 0.31 0.31 0.0 0 0 639.94 122.92 L 639.94 3.47 A 0.31 0.31 0.0 0 1 640.25 3.16 Z"/>
                <path fill="#00225D" d="M 779.90 122.52 A 0.27 0.27 0.0 0 0 780.43 122.43 L 780.41 3.40 A 0.31 0.31 0.0 0 1 780.72 3.09 L 812.32 3.08 A 0.33 0.32 90.0 0 1 812.64 3.41 L 812.66 177.68 A 0.46 0.45 -0.0 0 1 812.20 178.13 L 773.15 178.14 A 0.64 0.63 -9.7 0 1 772.55 177.72 L 729.76 55.66 A 0.28 0.28 0.0 0 0 729.21 55.75 L 729.23 177.65 A 0.50 0.50 0.0 0 1 728.73 178.15 L 697.60 178.15 A 0.56 0.56 0.0 0 1 697.04 177.59 L 697.03 3.40 A 0.30 0.29 90.0 0 1 697.32 3.10 L 736.99 3.09 A 0.81 0.81 0.0 0 1 737.75 3.63 L 779.90 122.52 Z"/>
                <rect fill="#00225D" x="838.92" y="3.13" width="35.46" height="175.00" rx="0.46"/>
                <path fill="#00225D" d="M 1035.10 10.98 A 7.52 7.52 0.0 0 1 1027.58 18.50 A 7.52 7.52 0.0 0 1 1020.06 10.98 A 7.52 7.52 0.0 0 1 1027.58 3.46 A 7.52 7.52 0.0 0 1 1035.10 10.98 Z M 1033.98 10.94 A 6.41 6.41 0.0 0 0 1027.57 4.53 A 6.41 6.41 0.0 0 0 1021.16 10.94 A 6.41 6.41 0.0 0 0 1027.57 17.35 A 6.41 6.41 0.0 0 0 1033.98 10.94 Z"/>
                <path fill="#00225D" d="M 1025.39 6.62 C 1027.74 6.47 1031.63 6.02 1031.02 9.82 A 1.13 1.11 80.5 0 1 1030.47 10.61 L 1029.52 11.16 A 0.67 0.66 -32.9 0 0 1029.31 12.12 L 1031.32 14.95 A 0.03 0.02 58.3 0 1 1031.32 14.98 L 1031.05 15.30 A 0.61 0.61 0.0 0 1 1030.06 15.21 L 1027.99 11.63 A 1.08 1.08 0.0 0 0 1025.97 12.17 L 1025.97 14.85 A 0.45 0.45 0.0 0 1 1025.52 15.30 L 1025.23 15.30 A 0.36 0.36 0.0 0 1 1024.87 14.94 L 1024.87 7.18 A 0.56 0.56 0.0 0 1 1025.39 6.62 Z M 1025.86 8.15 L 1025.88 9.87 A 0.65 0.65 0.0 0 0 1026.53 10.51 L 1027.99 10.50 A 1.93 1.35 -0.5 0 0 1029.91 9.13 L 1029.91 8.81 A 1.93 1.35 -0.5 0 0 1027.97 7.48 L 1026.51 7.49 A 0.65 0.65 0.0 0 0 1025.86 8.15 Z"/>
                <path fill="#4BB748" d="M 69.98 299.25 L 0.61 299.25 A 0.35 0.35 0.0 0 1 0.26 298.90 L 0.26 88.07 A 0.35 0.35 0.0 0 1 0.66 87.72 L 125.10 104.20 A 0.35 0.35 0.0 0 1 125.39 104.64 L 70.31 299.00 A 0.35 0.35 0.0 0 1 69.98 299.25 Z"/>
                <path fill="#4BB748" d="M 187.79 111.46 L 296.16 125.82 A 0.47 0.47 0.0 0 1 296.57 126.28 L 296.57 298.78 A 0.47 0.47 0.0 0 1 296.10 299.25 L 134.78 299.25 A 0.47 0.47 0.0 0 1 134.33 298.65 L 187.28 111.80 A 0.47 0.47 0.0 0 1 187.79 111.46 Z"/>
                <path fill="#00225D" d="M 361.23 300.00 L 353.66 300.00 Q 339.92 299.35 333.34 289.15 C 329.23 282.78 328.19 274.28 327.72 265.53 Q 326.67 246.28 328.86 232.29 C 331.79 213.47 344.45 206.75 362.45 208.50 Q 370.49 209.27 375.91 213.59 C 383.70 219.81 384.78 229.45 384.94 239.33 A 0.54 0.54 0.0 0 1 384.40 239.88 L 367.69 239.88 A 0.63 0.63 0.0 0 1 367.06 239.25 C 367.03 231.48 366.38 220.96 355.61 221.59 C 348.34 222.02 346.72 229.56 346.02 235.57 Q 344.94 244.90 345.12 260.04 C 345.20 266.51 345.32 274.82 347.97 281.61 C 349.49 285.51 351.96 287.18 356.27 287.34 C 367.48 287.75 368.04 273.40 367.85 265.44 A 0.67 0.67 0.0 0 1 368.52 264.75 L 385.06 264.75 A 0.58 0.58 0.0 0 1 385.64 265.33 Q 385.65 277.66 382.67 285.39 Q 377.45 298.90 361.23 300.00 Z"/>
                <path fill="#00225D" d="M 461.43 244.00 Q 470.80 244.00 471.28 243.94 A 0.64 0.64 0.0 0 0 471.87 243.30 L 471.88 210.68 A 0.56 0.56 0.0 0 1 472.44 210.12 L 489.36 210.12 A 0.39 0.39 0.0 0 1 489.75 210.51 L 489.75 298.44 A 0.44 0.44 0.0 0 1 489.31 298.88 L 472.42 298.88 A 0.55 0.55 0.0 0 1 471.87 298.33 L 471.87 259.74 A 0.34 0.34 0.0 0 0 471.54 259.40 Q 470.94 259.38 461.44 259.38 Q 451.93 259.38 451.33 259.40 A 0.34 0.34 0.0 0 0 451.00 259.74 L 451.01 298.33 A 0.55 0.55 0.0 0 1 450.46 298.88 L 433.57 298.88 A 0.44 0.44 0.0 0 1 433.13 298.44 L 433.12 210.51 A 0.39 0.39 0.0 0 1 433.51 210.12 L 450.43 210.12 A 0.56 0.56 0.0 0 1 450.99 210.68 L 451.00 243.30 A 0.64 0.64 0.0 0 0 451.59 243.94 Q 452.07 244.00 461.43 244.00 Z"/>
                <path fill="#00225D" d="M 567.78 210.12 Q 573.11 210.12 578.39 210.10 A 0.51 0.51 0.0 0 1 578.89 210.49 L 602.24 298.42 A 0.36 0.35 82.4 0 1 601.90 298.87 L 584.29 298.87 A 0.71 0.71 0.0 0 1 583.60 298.31 L 579.74 280.86 A 0.77 0.76 -5.7 0 0 579.00 280.26 Q 577.62 280.25 567.81 280.25 Q 558.01 280.25 556.63 280.27 A 0.77 0.76 5.7 0 0 555.89 280.87 L 552.04 298.32 A 0.71 0.71 0.0 0 1 551.35 298.88 L 533.74 298.90 A 0.36 0.35 -82.5 0 1 533.40 298.45 L 556.68 210.50 A 0.51 0.51 0.0 0 1 557.18 210.11 Q 562.46 210.13 567.78 210.12 Z M 559.14 265.10 A 0.34 0.34 0.0 0 0 559.47 265.51 L 576.03 265.51 A 0.34 0.34 0.0 0 0 576.36 265.10 L 568.08 226.48 A 0.34 0.34 0.0 0 0 567.42 226.48 L 559.14 265.10 Z"/>
                <path fill="#00225D" d="M 687.73 270.30 A 0.29 0.29 0.0 0 0 688.30 270.21 L 688.29 210.69 A 0.58 0.58 0.0 0 1 688.87 210.11 L 704.25 210.11 A 0.34 0.34 0.0 0 1 704.59 210.45 L 704.61 298.54 A 0.33 0.33 0.0 0 1 704.28 298.87 L 684.57 298.88 A 0.53 0.53 0.0 0 1 684.07 298.52 L 662.58 237.19 A 0.25 0.25 0.0 0 0 662.10 237.27 L 662.11 298.32 A 0.56 0.56 0.0 0 1 661.55 298.88 L 646.41 298.88 A 0.63 0.63 0.0 0 1 645.78 298.25 L 645.77 210.74 A 0.63 0.62 -0.0 0 1 646.40 210.12 L 666.01 210.12 A 0.88 0.88 0.0 0 1 666.84 210.70 L 687.73 270.30 Z"/>
                <path fill="#00225D" d="M 796.27 270.30 A 0.29 0.29 0.0 0 0 796.84 270.21 L 796.84 210.71 A 0.58 0.58 0.0 0 1 797.42 210.13 L 812.80 210.13 A 0.34 0.34 0.0 0 1 813.14 210.47 L 813.14 298.54 A 0.33 0.33 0.0 0 1 812.81 298.87 L 793.11 298.87 A 0.53 0.53 0.0 0 1 792.61 298.51 L 771.13 237.19 A 0.25 0.25 0.0 0 0 770.65 237.27 L 770.65 298.31 A 0.56 0.56 0.0 0 1 770.09 298.87 L 754.96 298.87 A 0.63 0.63 0.0 0 1 754.33 298.24 L 754.33 210.75 A 0.63 0.62 -0.0 0 1 754.96 210.13 L 774.57 210.13 A 0.88 0.88 0.0 0 1 775.40 210.71 L 796.27 270.30 Z"/>
                <path fill="#00225D" d="M 880.74 260.69 L 880.74 283.68 A 0.32 0.32 0.0 0 0 881.06 284.00 L 913.30 284.00 A 0.32 0.32 0.0 0 1 913.62 284.32 L 913.62 298.56 A 0.32 0.32 0.0 0 1 913.30 298.88 L 863.19 298.88 A 0.32 0.32 0.0 0 1 862.87 298.56 L 862.87 210.44 A 0.32 0.32 0.0 0 1 863.19 210.12 L 912.18 210.12 A 0.32 0.32 0.0 0 1 912.50 210.44 L 912.50 224.55 A 0.32 0.32 0.0 0 1 912.18 224.87 L 881.06 224.87 A 0.32 0.32 0.0 0 0 880.74 225.19 L 880.74 245.31 A 0.32 0.32 0.0 0 0 881.06 245.63 L 910.18 245.63 A 0.32 0.32 0.0 0 1 910.50 245.95 L 910.50 260.05 A 0.32 0.32 0.0 0 1 910.18 260.37 L 881.06 260.37 A 0.32 0.32 0.0 0 0 880.74 260.69 Z"/>
                <path fill="#00225D" d="M 978.08 284.00 L 1009.16 284.00 A 0.34 0.34 0.0 0 1 1009.50 284.34 L 1009.50 298.54 A 0.34 0.34 0.0 0 1 1009.16 298.88 L 960.21 298.88 A 0.34 0.34 0.0 0 1 959.87 298.54 L 959.87 210.47 A 0.34 0.34 0.0 0 1 960.21 210.13 L 977.40 210.13 A 0.34 0.34 0.0 0 1 977.74 210.47 L 977.74 283.66 A 0.34 0.34 0.0 0 0 978.08 284.00 Z"/>
              </svg>
            </div>
          </div>
          
          <div className="text-center">
            <h1 className="text-4xl font-bold text-gray-900 mb-2" style={{ fontFamily: 'Oswald, sans-serif' }}>
              Tennis Channel Liaison
            </h1>
            <p className="text-gray-600" style={{ fontFamily: 'Roboto, sans-serif' }}>
              A custom GPT trained on the Tennis Channel Brand
            </p>
          </div>
        </div>
      </header>

      {/* Chat messages */}
      <div className="flex-1 overflow-y-auto">
        <div className="max-w-4xl mx-auto px-6 py-8">
          <div className="space-y-6" style={{ fontFamily: 'Roboto, sans-serif' }}>
            {messages.map((message, index) => (
              <div
                key={index}
                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}
              >
                <div
                  className={`max-w-3xl rounded-2xl px-6 py-4 ${
                    message.role === 'user'
                      ? 'bg-white/95 backdrop-blur-sm text-gray-900 shadow-lg'
                      : 'bg-white/90 backdrop-blur-sm text-gray-800 shadow-lg border border-white/20'
                  }`}
                >
                  {typeof message.content === 'string' ? (
                    <div 
                      className="text-base leading-relaxed" 
                      dangerouslySetInnerHTML={{ __html: formatText(message.content) }}
                    />
                  ) : (
                    <div className="space-y-2">
                      {message.content.map((item: any, idx: number) => (
                        item.type === 'text' ? (
                          <div 
                            key={idx} 
                            className="text-base leading-relaxed" 
                            dangerouslySetInnerHTML={{ __html: formatText(item.text) }}
                          />
                        ) : (
                          <img key={idx} src={item.image_url.url} alt="Uploaded" className="max-w-md max-h-96 object-contain rounded-lg" />
                        )
                      ))}
                    </div>
                  )}
                </div>
              </div>
            ))}
            
            {isLoading && (
              <div className="flex justify-start">
                <div className="bg-white/90 backdrop-blur-sm text-gray-800 shadow-lg border border-white/20 rounded-2xl px-6 py-4">
                  <div className="flex gap-2">
                    <div className="w-2 h-2 bg-[#00225D] rounded-full animate-bounce" style={{ animationDelay: '0ms' }} />
                    <div className="w-2 h-2 bg-[#00225D] rounded-full animate-bounce" style={{ animationDelay: '150ms' }} />
                    <div className="w-2 h-2 bg-[#00225D] rounded-full animate-bounce" style={{ animationDelay: '300ms' }} />
                  </div>
                </div>
              </div>
            )}
            <div ref={messagesEndRef} />
          </div>
        </div>
      </div>

      {/* Input area */}
      <div className="border-t border-white/20 bg-white/95 backdrop-blur-sm py-6">
        <div className="max-w-4xl mx-auto px-6" style={{ fontFamily: 'Roboto, sans-serif' }}>
          {uploadedImages.length > 0 && (
            <div className="flex gap-2 mb-3 flex-wrap">
              {uploadedImages.map((img, idx) => (
                <div key={idx} className="relative">
                  <img src={img} alt="Upload preview" className="h-20 w-20 object-cover rounded-lg" />
                  <button
                    onClick={() => removeImage(idx)}
                    className="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"
                  >
                    ×
                  </button>
                </div>
              ))}
            </div>
          )}
          <div className="flex gap-3">
            <input
              type="file"
              ref={fileInputRef}
              onChange={handleImageUpload}
              accept="image/*"
              multiple
              className="hidden"
            />
            <button
              onClick={() => fileInputRef.current?.click()}
              disabled={isLoading}
              className="px-4 py-4 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
            >
              <ImageIcon size={20} />
            </button>
            <input
              type="text"
              value={input}
              onChange={(e) => setInput(e.target.value)}
              onKeyPress={handleKeyPress}
              placeholder="Describe your creative materials or ask for feedback"
              className="flex-1 px-5 py-4 text-base border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#00225D] focus:border-transparent transition-all"
              disabled={isLoading}
            />
            <button
              onClick={handleSubmit}
              disabled={isLoading || (!input.trim() && uploadedImages.length === 0)}
              className="px-8 py-4 bg-[#00225D] hover:bg-[#4472C4] text-white rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg"
            >
              <Send size={20} />
              <span>Send</span>
            </button>
          </div>
          <p className="text-sm text-gray-600 mt-3 text-center">
            Powered by OpenAI • Built by Direct Agents
          </p>
        </div>
      </div>
    </div>
  );
}